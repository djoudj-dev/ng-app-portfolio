<aside
  class="fixed left-0 top-0 h-full z-20 overflow-hidden bg-background text-text shadow-primary-md transition-all duration-300"
  [ngClass]="{
    'w-[250px]': expanded(),
    'w-[64px]': !expanded(),
  }"
  (mouseenter)="expandOnHover() ? setExpanded(true) : null"
  (mouseleave)="expandOnHover() ? setExpanded(false) : null"
>
  <!-- Header -->
  <div class="p-4 flex items-center justify-between">
    <h2 class="text-xl font-bold whitespace-nowrap overflow-hidden">
      {{ expanded() ? 'Admin Panel' : 'A' }}
    </h2>
    <button class="text-text hover:text-accent transition" (click)="toggleSidebar()" aria-label="Toggle sidebar">
      ✕
    </button>
  </div>

  <!-- Navigation -->
  <nav class="mt-6">
    <ul class="space-y-2 px-2">
      @for (item of menuItems; track item.label) {
        <li>
          <a
            [routerLink]="item.route"
            routerLinkActive="bg-primary text-text shadow-accent-md"
            [routerLinkActiveOptions]="{ exact: item.exact }"
            class="flex items-center p-3 rounded-lg transition-colors hover:bg-primary-100 group"
          >
            <img
              [ngSrc]="item.icon"
              class="w-6 h-6 flex-shrink-0 icon-invert"
              [alt]="item.label"
              width="24"
              height="24"
            />
            <span
              class="ml-3 whitespace-nowrap overflow-hidden transition-opacity duration-300"
              [class.opacity-0]="!expanded() && !expandedTemporarily()"
            >
              {{ item.label }}
            </span>
          </a>
        </li>
      }
    </ul>
  </nav>

  <!-- Expand/Collapse Toggle -->
  <div class="absolute bottom-4 left-0 right-0 px-4">
    <button
      class="w-full flex items-center justify-center p-2 rounded-lg bg-accent text-text hover:bg-accent-600 transition"
      (click)="toggleExpandMode()"
    >
      <img
        [ngSrc]="icons"
        width="24"
        height="24"
        alt="Changer le mode d’expansion du menu"
        class="w-6 aspect-square object-contain icon-invert"
      />
      <span
        class="ml-2 whitespace-nowrap overflow-hidden transition-opacity duration-300"
        [class.opacity-0]="!expanded()"
      >
        {{ expandOnHover() ? 'Bloquer le menu' : 'Débloquer le menu' }}
      </span>
    </button>
  </div>
</aside>

<!-- Overlay mobile -->
@if (expanded() && isMobile()) {
  <div class="fixed inset-0 bg-background bg-opacity-50 z-10" (click)="setExpanded(false)"></div>
}
